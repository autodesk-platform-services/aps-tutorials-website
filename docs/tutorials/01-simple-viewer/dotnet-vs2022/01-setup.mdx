---
sidebar_position: 1
---

import SetupVS2022 from '../../_shared/setup-vs2022/01-create-project.md';
import AddDependencies from '../../_shared/setup-vs2022/02-add-dependencies.md';

# Application Setup

In this step we're going to create a new .NET 6 project, install all the required dependencies,
and setup a basic ASP.NET server.

## Project setup

<SetupVS2022 />

### Add dependencies

<AddDependencies />

### Application config

In order to be able to run our app, we need to provide a "launch configuration" for it,
specifying things such as environment variables, and the address and port the server should
be listening on. Open the `launchSettings.json` file in the `Properties` folder, add the
`FORGE_CLIENT_ID` and `FORGE_CLIENT_SECRET` environment variables with your Forge app credentials
(and optionally the `FORGE_BUCKET` variable if you already have a bucket you want to use),
and set the `applicationUrl` to `http://localhost:8080`.

![Launch Settings](launch-settings.png)

## Basic server

Next we'll setup our basic server. Start by creating a `Startup.cs` file in the root folder
of your project with the following content:

```csharp title="Startup.cs"
using System;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;

public class Startup
{
    public Startup(IConfiguration configuration)
    {
        Configuration = configuration;
    }

    public IConfiguration Configuration { get; }

    // This method gets called by the runtime. Use this method to add services to the container.
    public void ConfigureServices(IServiceCollection services)
    {
        services.AddControllers();
        var ForgeClientID = Environment.GetEnvironmentVariable("FORGE_CLIENT_ID");
        var ForgeClientSecret = Environment.GetEnvironmentVariable("FORGE_CLIENT_SECRET");
        var ForgeBucket = Environment.GetEnvironmentVariable("FORGE_BUCKET"); // Optional
        if (string.IsNullOrEmpty(ForgeClientID) || string.IsNullOrEmpty(ForgeClientSecret))
        {
            throw new ApplicationException("Missing required environment variables FORGE_CLIENT_ID or FORGE_CLIENT_SECRET.");
        }
    }

    // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
    public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
    {
        if (env.IsDevelopment())
        {
            app.UseDeveloperExceptionPage();
        }
        app.UseHttpsRedirection();
        app.UseDefaultFiles();
        app.UseStaticFiles();
        app.UseRouting();
        app.UseEndpoints(endpoints =>
        {
            endpoints.MapControllers();
        });
    }
}
```

The `Startup` class is responsible for configuring our server and its "middleware", for example,
serving of static files. We also try and retrieve the Forge application client ID and secret
(these are the values you obtain when [creating a new Forge application](../../../intro#create-an-app))
from environment variables for later use.

Next, replace the content of `Program.cs` with the following:

```csharp title="Program.cs"
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Hosting;

public class Program
{
    public static void Main(string[] args)
    {
        CreateHostBuilder(args).Build().Run();
    }

    public static IHostBuilder CreateHostBuilder(string[] args) =>
        Host.CreateDefaultBuilder(args)
            .ConfigureWebHostDefaults(webBuilder =>
            {
                webBuilder.UseStartup<Startup>();
            });
}
```

This code will make sure that the .NET application creates a web server with our
new `Startup` class.

## Try it out

Now that we have a basic ASP.NET application setup, let's try it out!

With your new launch settings, you can now start the application (for example, using
the _Debug_ > _Start Debugging_ menu item, or by pressing `F5`). Visual Studio will automatically
open the [http://localhost:8080](http://localhost:8080) URL in your browser. You should get
a 404 response because we haven't implemented any server logic yet. That's going to be the goal
of the next step.

:::info
When starting the application for the first time you may be prompted to trust the self-signed
SSL certificate generated by ASP.NET Core. This is expected, and you can accept this prompt.
:::
