"use strict";(self.webpackChunkaps_tutorials_website=self.webpackChunkaps_tutorials_website||[]).push([[6700],{5589:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>g,frontMatter:()=>l,metadata:()=>p,toc:()=>u});var a=t(8168),i=(t(6540),t(5680));const r={toc:[]},o="wrapper";function s(e){let{components:n,...s}=e;return(0,i.yg)(o,(0,a.A)({},r,s,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"Final folder structure",src:t(8646).A,width:"3195",height:"1504"})))}s.isMDXComponent=!0;const l={},c="UI Framework",p={unversionedId:"tutorials/acc-issues/ui",id:"tutorials/acc-issues/ui",title:"UI Framework",description:"Ok, we will build the client-side piece of our application now.",source:"@site/docs/03-tutorials/06-acc-issues/07-ui.mdx",sourceDirName:"03-tutorials/06-acc-issues",slug:"/tutorials/acc-issues/ui",permalink:"/tutorials/acc-issues/ui",draft:!1,editUrl:"https://github.com/autodesk-platform-services/aps-tutorials-website/edit/master/docs/03-tutorials/06-acc-issues/07-ui.mdx",tags:[],version:"current",sidebarPosition:7,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Project Admin",permalink:"/tutorials/acc-issues/admin"},next:{title:"Table",permalink:"/tutorials/acc-issues/table"}},d={},u=[{value:"Table place holder",id:"table-place-holder",level:2},{value:"Sidebar logic",id:"sidebar-logic",level:2},{value:"Application logic",id:"application-logic",level:2},{value:"User interface",id:"user-interface",level:2},{value:"Try it out",id:"try-it-out",level:2}],h={toc:u},m="wrapper";function g(e){let{components:n,...r}=e;return(0,i.yg)(m,(0,a.A)({},h,r,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"ui-framework"},"UI Framework"),(0,i.yg)("p",null,"Ok, we will build the client-side piece of our application now."),(0,i.yg)("h2",{id:"table-place-holder"},"Table place holder"),(0,i.yg)("p",null,"Let's start by implementing a place holder functions of Table,\nCreate a ",(0,i.yg)("inlineCode",{parentName:"p"},"table.js")," file under the ",(0,i.yg)("inlineCode",{parentName:"p"},"wwwroot")," subfolder with the following code:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="wwwroot/table.js"',title:'"wwwroot/table.js"'},"const TABLE_TABS = {\n    ISSUES: {\n        REQUEST_URL: '/api/issues/issues',\n        TAB_NAME: 'ISSUES',\n        VISIBILITY: true,\n        IMPORT_ATTRIBUTES_KEYS: [\n            'id',\n            'title',\n            'description',\n            'issueSubtypeId',\n            'status',\n            'dueDate',\n            'assignedTo',\n            'assignedToType',\n            'rootCauseId',\n            'published'\n        ]\n    },\n\n    'USERS': {\n        'REQUEST_URL': '/api/admin/projectUsers',\n        'TAB_NAME': 'USERS',\n        'VISIBILITY': false\n    },\n    'ISSUE_SUBTYPES': {\n        'REQUEST_URL': '/api/issues/subtypes',\n        'TAB_NAME': 'SUBTYPES',\n        'VISIBILITY': false\n    },\n    'ISSUE_ROOTCAUSES': {\n        'REQUEST_URL': '/api/issues/rootcauses',\n        'TAB_NAME': 'ROOT_CAUSES',\n        'VISIBILITY': false\n    },\n    'ISSUE_CUSTOM_ATTRIBUTES_DEFS': {\n        'REQUEST_URL': '/api/issues/customAttDefs',\n        'TAB_NAME': 'CUSTOM_ATTRIBUTES_DEFS',\n        'VISIBILITY': false\n    }\n}\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////\n//Table class wraps the specific data info\nclass Table {\n    #tableId;\n    #accountId;\n    #projectId;\n    #tabKey;\n    #dataSet;\n    #maxItem;\n\n    constructor(tableId, accountId = null, projectId = null, tabKey = 'PROJECTS') {\n        this.#tableId = tableId;\n        this.#accountId = accountId;\n        this.#projectId = projectId;\n        this.#tabKey = tabKey;\n        this.#dataSet = null;\n        this.#maxItem = 5;\n    };\n\n    get tabKey(){\n        return this.#tabKey;\n    }\n\n    set tabKey( tabKey){\n        this.#tabKey = tabKey;\n    }\n\n    resetData = async( tabKey=null, accountId=null, projectId=null ) =>{\n        //TBD\n    }\n\n    drawTable = () => {\n        //TBD\n    }\n\n    exportToCSV = ()=>{\n        //TBD\n    }\n\n    importFromCSV = async() => {\n        //TBD\n    }    \n}\n\n\nexport async function refreshTable(accountId = null, projectId = null) {\n    $(\"#loadingoverlay\").fadeIn()\n\n    const activeTab = $(\"ul#issueTableTabs li.active\")[0].id;\n    // highlight-start\n    try {\n        await g_accDataTable.resetData(activeTab, accountId, projectId);\n        g_accDataTable.drawTable();\n    } catch (err) {\n        console.warn(err);\n    }\n    // highlight-end\n    $(\"#loadingoverlay\").fadeOut()\n}\n\nexport async function initTableTabs() {\n    // add all tabs\n    for (let key in TABLE_TABS) {\n        $('<li id=' + key + '><a href=\"accTable\" data-toggle=\"tab\">' + TABLE_TABS[key].TAB_NAME + '</a></li>').appendTo('#issueTableTabs');\n    }\n    $(\"#ISSUES\").addClass(\"active\");\n    // event on the tabs\n    $('a[data-toggle=\"tab\"]').on('shown.bs.tab', async function (e) {\n        $(\"#loadingoverlay\").fadeIn()\n        const activeTab = e.target.parentElement.id;\n        // highlight-start\n        try {\n            await g_accDataTable.resetData(activeTab);\n            g_accDataTable.drawTable();\n        } catch (err) {\n            console.warn(err);\n        }\n        // highlight-end\n        $(\"#loadingoverlay\").fadeOut()\n    });\n}\n\nvar g_accDataTable = new Table('#accTable');\n")),(0,i.yg)("p",null,"The script is an ",(0,i.yg)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules"},"ES6 module"),"\nthat define a class ",(0,i.yg)("inlineCode",{parentName:"p"},"Table")," which is used to list the information of Projects and Users, the module also\nexports two functions:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"initTableTabs")," will create the Tabs and also register the function when active tab is changed."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"refreshTable")," for loading the data of selected tab into the table.")),(0,i.yg)("h2",{id:"sidebar-logic"},"Sidebar logic"),(0,i.yg)("p",null,"Next we'll implement the behavior of a sidebar where we're going to display\nall the ACC hubs and projects in a 3rd party tree-view component.\nCreate a ",(0,i.yg)("inlineCode",{parentName:"p"},"sidebar.js")," file under the ",(0,i.yg)("inlineCode",{parentName:"p"},"wwwroot")," subfolder with the following code:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="wwwroot/sidebar.js"',title:'"wwwroot/sidebar.js"'},"async function getJSON(url) {\n    const resp = await fetch(url);\n    if (!resp.ok) {\n        alert('Could not load tree data. See console for more details.');\n        console.error(await resp.text());\n        return [];\n    }\n    return resp.json();\n}\n\nfunction createTreeNode(id, text, icon, children = false) {\n    return { id, text, children, itree: { icon } };\n}\n\nasync function getHubs() {\n    const hubs = await getJSON('/api/hubs');\n    return hubs.map(hub => createTreeNode(`hub|${hub.id}`, hub.name, 'icon-hub', true));\n}\n\nasync function getProjects(hubId) {\n    const projects = await getJSON(`/api/hubs/${hubId}/projects`);\n    return projects.map(project => createTreeNode(`project|${hubId}|${project.id}`, project.name, 'icon-project', false));\n}\n\n\nexport function initTree(selector, onSelectionChanged) {\n    // See http://inspire-tree.com\n    const tree = new InspireTree({\n        data: function (node) {\n            if (!node || !node.id) {\n                return getHubs();\n            } else {\n                const tokens = node.id.split('|');\n                switch (tokens[0]) {\n                    case 'hub': return getProjects(tokens[1]);\n                    default: return [];\n                }\n            }\n        }\n    });\n    tree.on('node.click', function (event, node) {\n        event.preventTreeDefault();\n        const tokens = node.id.split('|');\n        if (tokens[0] === 'project') {\n            onSelectionChanged( tokens[1],tokens[2]);\n        }\n    });\n    return new InspireTreeDOM(tree, { target: selector });\n}\n\n")),(0,i.yg)("h2",{id:"application-logic"},"Application logic"),(0,i.yg)("p",null,"Now let's wire all the UI components together. Create a ",(0,i.yg)("inlineCode",{parentName:"p"},"main.js")," file under\nthe ",(0,i.yg)("inlineCode",{parentName:"p"},"wwwroot")," folder, and populate it with the following code:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="wwwroot/main.js"',title:'"wwwroot/main.js"'},"import { refreshTable, initTableTabs } from './table.js';\nimport { initTree } from './sidebar.js';\n\nconst login = document.getElementById('login');\ntry {\n    const resp = await fetch('/api/auth/profile');\n    if (resp.ok) {\n        const user = await resp.json();\n        login.innerText = `Logout (${user.name})`;\n        login.onclick = () => {\n            const iframe = document.createElement('iframe');\n            iframe.style.visibility = 'hidden';\n            iframe.src = 'https://accounts.autodesk.com/Authentication/LogOut';\n            document.body.appendChild(iframe);\n            iframe.onload = () => {\n                window.location.replace('/api/auth/logout');\n                document.body.removeChild(iframe);\n            };\n        }\n        initTree('#tree', (accountId, projectId) => refreshTable(accountId,projectId.replace('b.','')));\n        await initTableTabs();\n    } else {\n        login.innerText = 'Login';\n        login.onclick = () => window.location.replace('/api/auth/login');\n    }\n    login.style.visibility = 'visible';\n} catch (err) {\n    alert('Could not initialize the application. See console for more details.');\n    console.error(err);\n}\n\n")),(0,i.yg)("p",null,"The script will first try and obtain user details to check whether we're logged in or not.\nIf we are, the code can then initialize the table as well as the tree-view component.\nThe callback function passed to ",(0,i.yg)("inlineCode",{parentName:"p"},"initTree")," makes sure that when we click on a leaf node\nin the tree, the table will start loading the corresponding data."),(0,i.yg)("h2",{id:"user-interface"},"User interface"),(0,i.yg)("p",null,"And finally, let's build the UI of our application."),(0,i.yg)("p",null,"Create a ",(0,i.yg)("inlineCode",{parentName:"p"},"main.css")," file under the ",(0,i.yg)("inlineCode",{parentName:"p"},"wwwroot")," subfolder, and populate it with the following CSS rules:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-css",metastring:'title="wwwroot/main.css"',title:'"wwwroot/main.css"'},"body, html {\n    margin: 0;\n    padding: 0;\n    height: 100vh;\n    font-family: ArtifaktElement;\n}\n\n#header, #sidebar, #table, #loadingoverlay {\n    position: absolute;\n}\n\n#header {\n    height: 3em;\n    width: 100%;\n    display: flex;\n    flex-flow: row nowrap;\n    justify-content: space-between;\n    align-items: center;\n}\n\n#sidebar {\n    width: 25%;\n    left: 0;\n    top: 3em;\n    bottom: 0;\n    overflow-y: scroll;\n}\n\n#table {\n    width: 75%;\n    right: 0;\n    top: 3em;\n    bottom: 0;\n    overflow-y: scroll;\n}\n\n#loadingoverlay{\n    top: 3em;\n    z-index: 90;\n    width: 100%;\n    height: 100%;\n    display: none;\n    background: rgba(0, 0, 0, 0.6);\n}\n\n.cv-spinner {\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.spinner {\n    width: 60px;\n    height: 60px;\n    border: 6px #ddd solid;\n    border-top: 6px #2e93e6 solid;\n    border-radius: 50%;\n    animation: sp-anime 0.8s infinite linear;\n}\n\n@keyframes sp-anime {\n    0% {\n        transform: rotate(0deg);\n    }\n    100% {\n        transform: rotate(359deg);\n    }\n}\n\n#header > * {\n    height: 2em;\n    margin: 0 0.5em;\n}\n\n#login {\n    font-family: ArtifaktElement;\n    font-size: 1em;\n}\n\n#header .title {\n    height: auto;\n    margin-right: auto;\n}\n\n#tree {\n    margin: 0.5em;\n}\n\n#workingAnimation {    \n    text-align: center;\n}\n\n@media (max-width: 768px) {\n    #sidebar {\n        width: 100%;\n        top: 3em;\n        bottom: 75%;\n    }\n    #table {\n        width: 100%;\n        top: 25%;\n        bottom: 0;\n    }\n}\n\n.icon-hub:before {\n    background-image: url(https://raw.githubusercontent.com/primer/octicons/main/icons/apps-16.svg); /* or https://raw.githubusercontent.com/primer/octicons/main/icons/stack-16.svg */\n    background-size: cover;\n}\n\n.icon-project:before {\n    \n    background-image: url(https://raw.githubusercontent.com/primer/octicons/main/icons/project-16.svg); /* or https://raw.githubusercontent.com/primer/octicons/main/icons/organization-16.svg */\n    background-size: cover;\n}\n")),(0,i.yg)("p",null,"Then, create an ",(0,i.yg)("inlineCode",{parentName:"p"},"index.html")," file in the same folder with the following content:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="wwwroot/index.html"',title:'"wwwroot/index.html"'},'<!doctype html>\n<html lang="en">\n\n<head>\n    <meta charset="utf-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <link rel="icon" type="image/x-icon" href="https://cdn.autodesk.io/favicon.ico">\n    <link rel="stylesheet" href="https://unpkg.com/inspire-tree-dom@4.0.6/dist/inspire-tree-light.min.css">\n    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">\n    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.2/dist/bootstrap-table.min.css">\n    <link rel="stylesheet" href="/main.css">\n\n    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"><\/script>\n    <script src="https://unpkg.com/inspire-tree@4.3.1/dist/inspire-tree.js"><\/script>\n    <script src="https://unpkg.com/inspire-tree-dom@4.0.6/dist/inspire-tree-dom.min.js"><\/script>\n    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"><\/script>\n    <script src="https://unpkg.com/bootstrap-table@1.22.2/dist/bootstrap-table.min.js"><\/script>\n    <script src="https://rawgit.com/michaelsogos/bootstrap-table-toolbar-buttons/master/src/bootstrap-table-toolbar-buttons.js"><\/script>\n    <script src="https://unpkg.com/axios/dist/axios.min.js"><\/script>\n    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"><\/script>\n    <script src="/main.js" type="module"><\/script>\n\n    <title>Autodesk Platform Services: ACC Issues</title>\n</head>\n\n<body>\n    <div id="header">\n        <img class="logo" src="https://cdn.autodesk.io/logo/black/stacked.png" alt="Autodesk Platform Services">\n        <span class="title">ACC Issues</span>\n        <button id="login" style="visibility: hidden;">Login</button>\n    </div>\n    <div id="sidebar">\n        <div id="tree"></div>\n    </div>\n    <div id="table">\n        <ul id="issueTableTabs" class="nav nav-tabs">\n        </ul>\n        \n        <table id="accTable" class="table-striped table-bordered table-hover">\n        </table>\n        <div id="loadingoverlay">\n            <div class="cv-spinner">\n                <span class="spinner"></span>\n            </div>\n        </div>\n    </div>\n</body>\n</html>\n')),(0,i.yg)("blockquote",null,(0,i.yg)("p",{parentName:"blockquote"},"Note that since ",(0,i.yg)("inlineCode",{parentName:"p"},"main.js")," is also an ES6 module, we have to use ",(0,i.yg)("inlineCode",{parentName:"p"},'type="module"')," in its ",(0,i.yg)("inlineCode",{parentName:"p"},"<script>")," tag.")),(0,i.yg)("p",null,"The final folder structure of your application's source code should now look something like this:"),(0,i.yg)(s,{mdxType:"NodeJsVsCodeStructure"}),(0,i.yg)("h2",{id:"try-it-out"},"Try it out"),(0,i.yg)("p",null,"Your application is now to ready to test for the framework. Start it as usual, and when you go to\n",(0,i.yg)("a",{parentName:"p",href:"http://localhost:8080"},"http://localhost:8080"),", you should be presented with a simple UI, with\na tree-view on the left side, and an empty table on the right. Try browsing through the tree,\nwe will load data into the table in next step."),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"Account Admin",src:t(7688).A,width:"2992",height:"1590"})))}g.isMDXComponent=!0},5680:(e,n,t)=>{t.d(n,{xA:()=>p,yg:()=>m});var a=t(6540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=a.createContext({}),c=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(l.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},h=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(t),h=i,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||r;return t?a.createElement(m,o(o({ref:n},p),{},{components:t})):a.createElement(m,o({ref:n},p))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=h;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[d]="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}h.displayName="MDXCreateElement"},7688:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/aps-acc-issue-55061dd28dbace3309467c2ac8404e5f.webp"},8646:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/final-folder-structure-221044df61d6c52476e6c984678a1605.webp"}}]);